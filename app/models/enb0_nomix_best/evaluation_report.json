{
  "timestamp": "2025-08-14T10:31",
  "model_file": "C:\Users\ruizm\Documents\MedicalImageDemo\app\models\enb0_imnet_ce_noosr_nomix_best",
  "num_test_samples": 18386,
  "label_space": "simplified",
  "label_names": [
    "cardiomegaly",
    "aortic elongation",
    "unchanged",
    "scoliosis",
    "costophrenic angle blunting",
    "air trapping",
    "pleural effusion",
    "interstitial pattern",
    "vertebral degenerative changes",
    "laminar atelectasis"
  ],
  "selected_label_idx": [
    0,
    2,
    1,
    4,
    7,
    8,
    3,
    5,
    13,
    12
  ],
  "per_label": {
    "cardiomegaly": {
      "threshold": 0.7069228887557983,
      "pr_auc_val": 0.5643284236741182,
      "validation_metrics": {
        "confusion_matrix": [
          [
            7844,
            478
          ],
          [
            298,
            505
          ]
        ],
        "accuracy": 0.914958904109589,
        "precision": 0.513733468972533,
        "recall": 0.6288916562889165,
        "f1_score": 0.5655095184770438,
        "f2_score": 0.601907032181168,
        "specificity": 0.9425618841613282,
        "negative_predictive_value": 0.9633996561029681,
        "g_mean": 0.7699151281050527,
        "youden_j": 0.5714535404502448,
        "matthews_corrcoef": 0.5221679936492672,
        "cohen_kappa": 0.5189064793873746,
        "balanced_accuracy": 0.7857267702251224,
        "roc_auc": 0.9230868052780924,
        "pr_auc": 0.5643284236741182,
        "brier_score": 0.07935819155021549
      },
      "test_metrics": {
        "confusion_matrix": [
          [
            15747,
            952
          ],
          [
            695,
            992
          ]
        ],
        "accuracy": 0.9104209724790602,
        "precision": 0.5102880658436214,
        "recall": 0.5880260818020154,
        "f1_score": 0.5464059487744423,
        "f2_score": 0.5706396686608375,
        "specificity": 0.9429905982388508,
        "negative_predictive_value": 0.9577302031377218,
        "g_mean": 0.7446496267766002,
        "youden_j": 0.5310166800408662,
        "matthews_corrcoef": 0.4985233268298682,
        "cohen_kappa": 0.49698529132062175,
        "balanced_accuracy": 0.7655083400204331,
        "roc_auc": 0.9113688324318872,
        "pr_auc": 0.550139312037629,
        "brier_score": 0.08137187186541418
      }
    },
    "aortic elongation": {
      "threshold": 0.6868770122528076,
      "pr_auc_val": 0.3656244410906654,
      "validation_metrics": {
        "confusion_matrix": [
          [
            7925,
            574
          ],
          [
            312,
            314
          ]
        ],
        "accuracy": 0.9029041095890411,
        "precision": 0.3536036036036036,
        "recall": 0.5015974440894568,
        "f1_score": 0.41479524438573306,
        "f2_score": 0.46285377358490565,
        "specificity": 0.9324626426627456,
        "negative_predictive_value": 0.9621221318429498,
        "g_mean": 0.6839012196717693,
        "youden_j": 0.4340600867522024,
        "matthews_corrcoef": 0.3701944625716157,
        "cohen_kappa": 0.36357960035184067,
        "balanced_accuracy": 0.7170300433761012,
        "roc_auc": 0.8818773830561535,
        "pr_auc": 0.3656244410906654,
        "brier_score": 0.08816077748876905
      },
      "test_metrics": {
        "confusion_matrix": [
          [
            15876,
            1164
          ],
          [
            701,
            645
          ]
        ],
        "accuracy": 0.8985641248776243,
        "precision": 0.35655058043117743,
        "recall": 0.47919762258543835,
        "f1_score": 0.4088748019017433,
        "f2_score": 0.44835256499374393,
        "specificity": 0.9316901408445236,
        "negative_predictive_value": 0.9577124932129107,
        "g_mean": 0.6681793924381295,
        "youden_j": 0.4108877634299619,
        "matthews_corrcoef": 0.3593422483631087,
        "cohen_kappa": 0.354701179769612,
        "balanced_accuracy": 0.705443881714981,
        "roc_auc": 0.873277150520757,
        "pr_auc": 0.34398789582977024,
        "brier_score": 0.09195460937582786
      }
    },
    "unchanged": {
      "threshold": 0.4734758734703064,
      "pr_auc_val": 0.14568832565071674,
      "validation_metrics": {
        "confusion_matrix": [
          [
            7126,
            1357
          ],
          [
            397,
            245
          ]
        ],
        "accuracy": 0.8077808219178082,
        "precision": 0.15293383270911362,
        "recall": 0.38161993769470404,
        "f1_score": 0.21836007130124777,
        "f2_score": 0.29376498800959233,
        "specificity": 0.840033007189862,
        "negative_predictive_value": 0.9472284992676496,
        "g_mean": 0.5661919673267097,
        "youden_j": 0.22165294488456588,
        "matthews_corrcoef": 0.1490009256666997,
        "cohen_kappa": 0.1310718426505082,
        "balanced_accuracy": 0.6108264724422829,
        "roc_auc": 0.6895183072760878,
        "pr_auc": 0.14568832565071674,
        "brier_score": 0.13740581427897275
      },
      "test_metrics": {
        "confusion_matrix": [
          [
            14268,
            2781
          ],
          [
            879,
            458
          ]
        ],
        "accuracy": 0.8009354943979115,
        "precision": 0.14140166718122876,
        "recall": 0.3425579655946148,
        "f1_score": 0.20017482517482518,
        "f2_score": 0.2666821940142075,
        "specificity": 0.8368819285583688,
        "negative_predictive_value": 0.941968706673967,
        "g_mean": 0.5354255979030631,
        "youden_j": 0.17943989415298356,
        "matthews_corrcoef": 0.12231096050732146,
        "cohen_kappa": 0.10838926374576419,
        "balanced_accuracy": 0.5897199470764918,
        "roc_auc": 0.6543857506409546,
        "pr_auc": 0.1355759988013416,
        "brier_score": 0.13983314624124346
      }
    },
    "scoliosis": {
      "threshold": 0.7466915845870972,
      "pr_auc_val": 0.3103109287921032,
      "validation_metrics": {
        "confusion_matrix": [
          [
            8200,
            446
          ],
          [
            287,
            192
          ]
        ],
        "accuracy": 0.9196712328767124,
        "precision": 0.30094043887147337,
        "recall": 0.40083507306889354,
        "f1_score": 0.3437779767233662,
        "f2_score": 0.37588097102584184,
        "specificity": 0.9484154522311491,
        "negative_predictive_value": 0.9661835748780885,
        "g_mean": 0.616569685513925,
        "youden_j": 0.34925052530004264,
        "matthews_corrcoef": 0.3054393591582149,
        "cohen_kappa": 0.30191722083812,
        "balanced_accuracy": 0.6746252626500213,
        "roc_auc": 0.7979657529251944,
        "pr_auc": 0.3103109287921032,
        "brier_score": 0.11065339105557939
      },
      "test_metrics": {
        "confusion_matrix": [
          [
            16405,
            939
          ],
          [
            610,
            432
          ]
        ],
        "accuracy": 0.9157511149787882,
        "precision": 0.3150984682713348,
        "recall": 0.4145873320537428,
        "f1_score": 0.35806050559469543,
        "f2_score": 0.3899620870193176,
        "specificity": 0.9458602398518531,
        "negative_predictive_value": 0.9641492800464506,
        "g_mean": 0.6262121631970214,
        "youden_j": 0.36044757190559595,
        "matthews_corrcoef": 0.31726041801902627,
        "cohen_kappa": 0.3138734768270426,
        "balanced_accuracy": 0.680223785952798,
        "roc_auc": 0.828889091284147,
        "pr_auc": 0.35482674496470185,
        "brier_score": 0.10975067718774553
      }
    },
    "costophrenic angle blunting": {
      "threshold": 0.8649069666862488,
      "pr_auc_val": 0.2998058438704852,
      "validation_metrics": {
        "confusion_matrix": [
          [
            8595,
            213
          ],
          [
            192,
            125
          ]
        ],
        "accuracy": 0.9556164383561644,
        "precision": 0.3698224852071006,
        "recall": 0.3943217665615142,
        "f1_score": 0.38167938931297707,
        "f2_score": 0.3891656288916563,
        "specificity": 0.9758174386909901,
        "negative_predictive_value": 0.978149539090727,
        "g_mean": 0.6203112575684592,
        "youden_j": 0.3701392052525043,
        "matthews_corrcoef": 0.3588845058295226,
        "cohen_kappa": 0.35868602673488603,
        "balanced_accuracy": 0.6850696026262522,
        "roc_auc": 0.8731197190967775,
        "pr_auc": 0.2998058438704852,
        "brier_score": 0.09059077523786281
      },
      "test_metrics": {
        "confusion_matrix": [
          [
            17321,
            397
          ],
          [
            428,
            240
          ]
        ],
        "accuracy": 0.9551289024257588,
        "precision": 0.37676609105180536,
        "recall": 0.3592814371257485,
        "f1_score": 0.36781609195402304,
        "f2_score": 0.36264732547597467,
        "specificity": 0.9775934078332895,
        "negative_predictive_value": 0.9758859654059518,
        "g_mean": 0.5926475887835891,
        "youden_j": 0.33687484495903797,
        "matthews_corrcoef": 0.34467318846129114,
        "cohen_kappa": 0.3445686410460872,
        "balanced_accuracy": 0.668437422479519,
        "roc_auc": 0.8593150221737359,
        "pr_auc": 0.288855216981993,
        "brier_score": 0.08955913107079994
      }
    },
    "air trapping": {
      "threshold": 0.7717624306678772,
      "pr_auc_val": 0.13391418095688987,
      "validation_metrics": {
        "confusion_matrix": [
          [
            8208,
            558
          ],
          [
            251,
            108
          ]
        ],
        "accuracy": 0.9113424657534247,
        "precision": 0.16216216216216217,
        "recall": 0.3008356545961003,
        "f1_score": 0.2107317073170732,
        "f2_score": 0.25689819219790677,
        "specificity": 0.9363449691981104,
        "negative_predictive_value": 0.9703274618737789,
        "g_mean": 0.5307409459769228,
        "youden_j": 0.23718062379421068,
        "matthews_corrcoef": 0.17726807855764268,
        "cohen_kappa": 0.16820536303525302,
        "balanced_accuracy": 0.6185903118971053,
        "roc_auc": 0.7482556369665783,
        "pr_auc": 0.13391418095688987,
        "brier_score": 0.17350379131609645
      },
      "test_metrics": {
        "confusion_matrix": [
          [
            16558,
            1148
          ],
          [
            496,
            184
          ]
        ],
        "accuracy": 0.9105841401066028,
        "precision": 0.13813813813813813,
        "recall": 0.27058823529411763,
        "f1_score": 0.18290258449304175,
        "f2_score": 0.22704837117472854,
        "specificity": 0.9351632215063056,
        "negative_predictive_value": 0.9709159141544675,
        "g_mean": 0.5030349548683006,
        "youden_j": 0.20575145680042328,
        "matthews_corrcoef": 0.1497932913363209,
        "cohen_kappa": 0.1408292040342557,
        "balanced_accuracy": 0.6028757284002116,
        "roc_auc": 0.723783521371951,
        "pr_auc": 0.10777729143604513,
        "brier_score": 0.17963687103425918
      }
    },
    "pleural effusion": {
      "threshold": 0.8400155901908875,
      "pr_auc_val": 0.5866239465705115,
      "validation_metrics": {
        "confusion_matrix": [
          [
            8666,
            138
          ],
          [
            122,
            199
          ]
        ],
        "accuracy": 0.9715068493150685,
        "precision": 0.5905044510385756,
        "recall": 0.6199376947040498,
        "f1_score": 0.6048632218844984,
        "f2_score": 0.6138186304750154,
        "specificity": 0.9843253066776643,
        "negative_predictive_value": 0.9861174328618728,
        "g_mean": 0.7811660268218326,
        "youden_j": 0.6042630013817141,
        "matthews_corrcoef": 0.590280670723162,
        "cohen_kappa": 0.5900928420275693,
        "balanced_accuracy": 0.802131500690857,
        "roc_auc": 0.9296195725250912,
        "pr_auc": 0.5866239465705115,
        "brier_score": 0.036532414820122205
      },
      "test_metrics": {
        "confusion_matrix": [
          [
            17497,
            257
          ],
          [
            232,
            400
          ]
        ],
        "accuracy": 0.9734036767105406,
        "precision": 0.60882800608828,
        "recall": 0.6329113924050633,
        "f1_score": 0.6206361520558572,
        "f2_score": 0.6279434850863423,
        "specificity": 0.9855243888695586,
        "negative_predictive_value": 0.9869140955491077,
        "g_mean": 0.7897782050731594,
        "youden_j": 0.618435781274622,
        "matthews_corrcoef": 0.6069828927284344,
        "cohen_kappa": 0.6068602769168152,
        "balanced_accuracy": 0.809217890637311,
        "roc_auc": 0.956487965628712,
        "pr_auc": 0.634544408819846,
        "brier_score": 0.0319457744527829
      }
    },
    "interstitial pattern": {
      "threshold": 0.6999356150627136,
      "pr_auc_val": 0.18786214076501379,
      "validation_metrics": {
        "confusion_matrix": [
          [
            8573,
            266
          ],
          [
            189,
            97
          ]
        ],
        "accuracy": 0.9501369863013699,
        "precision": 0.26721763085399447,
        "recall": 0.33916083916083917,
        "f1_score": 0.29892141756548535,
        "f2_score": 0.3218314532183145,
        "specificity": 0.9699060979737867,
        "negative_predictive_value": 0.9784295822860323,
        "g_mean": 0.5735452607214225,
        "youden_j": 0.30906693713462596,
        "matthews_corrcoef": 0.2755384397528944,
        "cohen_kappa": 0.2734477220972864,
        "balanced_accuracy": 0.654533468567313,
        "roc_auc": 0.8188471783901132,
        "pr_auc": 0.18786214076501379,
        "brier_score": 0.053515988015753316
      },
      "test_metrics": {
        "confusion_matrix": [
          [
            17263,
            513
          ],
          [
            400,
            210
          ]
        ],
        "accuracy": 0.9503426520178396,
        "precision": 0.29045643153526973,
        "recall": 0.3442622950819672,
        "f1_score": 0.3150787696924231,
        "f2_score": 0.33196332595637057,
        "specificity": 0.9711408640858623,
        "negative_predictive_value": 0.9773537904087769,
        "g_mean": 0.5782103274052477,
        "youden_j": 0.31540315916782946,
        "matthews_corrcoef": 0.29063411716264614,
        "cohen_kappa": 0.2895082373259358,
        "balanced_accuracy": 0.6577015795839147,
        "roc_auc": 0.8249824777559724,
        "pr_auc": 0.22803135458221513,
        "brier_score": 0.05240429558032024
      }
    },
    "vertebral degenerative changes": {
      "threshold": 0.5531110763549805,
      "pr_auc_val": 0.10435309967276889,
      "validation_metrics": {
        "confusion_matrix": [
          [
            8232,
            627
          ],
          [
            184,
            82
          ]
        ],
        "accuracy": 0.9111232876712329,
        "precision": 0.1156558533145275,
        "recall": 0.3082706766917293,
        "f1_score": 0.1682051282051282,
        "f2_score": 0.23124647490129724,
        "specificity": 0.9292245174388426,
        "negative_predictive_value": 0.9781368821281152,
        "g_mean": 0.5352127341435531,
        "youden_j": 0.23749519413057185,
        "matthews_corrcoef": 0.14924920070929107,
        "cohen_kappa": 0.13137947438679387,
        "balanced_accuracy": 0.6187475970652859,
        "roc_auc": 0.7638517220922267,
        "pr_auc": 0.10435309967276889,
        "brier_score": 0.07142578177799107
      },
      "test_metrics": {
        "confusion_matrix": [
          [
            16527,
            1282
          ],
          [
            395,
            182
          ]
        ],
        "accuracy": 0.9087892962036332,
        "precision": 0.12431693989071038,
        "recall": 0.31542461005199307,
        "f1_score": 0.178343949044586,
        "f2_score": 0.24125132555673381,
        "specificity": 0.9280139255427435,
        "negative_predictive_value": 0.9766576054834082,
        "g_mean": 0.5410345927823277,
        "youden_j": 0.2434385355947366,
        "matthews_corrcoef": 0.15678359435353187,
        "cohen_kappa": 0.13960811321012712,
        "balanced_accuracy": 0.6217192677973683,
        "roc_auc": 0.7774678800945094,
        "pr_auc": 0.11553294924053674,
        "brier_score": 0.07185667367075621
      }
    },
    "laminar atelectasis": {
      "threshold": 0.8420376181602478,
      "pr_auc_val": 0.2053701477033374,
      "validation_metrics": {
        "confusion_matrix": [
          [
            8562,
            284
          ],
          [
            188,
            91
          ]
        ],
        "accuracy": 0.9482739726027397,
        "precision": 0.24266666666666667,
        "recall": 0.32616487455197135,
        "f1_score": 0.27828746177370034,
        "f2_score": 0.3051643192488263,
        "specificity": 0.9678950938266245,
        "negative_predictive_value": 0.9785142857131673,
        "g_mean": 0.5618659821144447,
        "youden_j": 0.2940599683785958,
        "matthews_corrcoef": 0.2550303194981581,
        "cohen_kappa": 0.25206216896761313,
        "balanced_accuracy": 0.6470299841892979,
        "roc_auc": 0.7911215971903143,
        "pr_auc": 0.2053701477033374,
        "brier_score": 0.12836329361354873
      },
      "test_metrics": {
        "confusion_matrix": [
          [
            17242,
            595
          ],
          [
            396,
            153
          ]
        ],
        "accuracy": 0.9461002937017295,
        "precision": 0.20454545454545456,
        "recall": 0.2786885245901639,
        "f1_score": 0.235929067077872,
        "f2_score": 0.25985054347826086,
        "specificity": 0.9666423725957466,
        "negative_predictive_value": 0.9775484748832194,
        "g_mean": 0.5190299958817834,
        "youden_j": 0.2453308971859105,
        "matthews_corrcoef": 0.21136051447486387,
        "cohen_kappa": 0.2086749823173062,
        "balanced_accuracy": 0.6226654485929553,
        "roc_auc": 0.7971224036159054,
        "pr_auc": 0.1583646060588227,
        "brier_score": 0.12949447141386838
      }
    }
  },
  "macro_test_metrics": {
    "confusion_matrix": 4596.5,
    "accuracy": 0.9170020667899488,
    "precision": 0.3066389842977021,
    "recall": 0.40255254965848647,
    "f1_score": 0.34142226957635097,
    "f2_score": 0.3726340891416517,
    "specificity": 0.9421501087927101,
    "negative_predictive_value": 0.9686836528955982,
    "g_mean": 0.6098202445109223,
    "youden_j": 0.3447026584511968,
    "matthews_corrcoef": 0.3057664552236413,
    "cohen_kappa": 0.3003998666513567,
    "balanced_accuracy": 0.6723513292255984,
    "roc_auc": 0.8207080095518531,
    "pr_auc": 0.29176357787529017,
    "brier_score": 0.0977807521893018
  },
  "micro_test_metrics": {
    "confusion_matrix": [
      [
        165300,
        9432
      ],
      [
        5531,
        3597
      ]
    ],
    "accuracy": 0.9186174263026216,
    "precision": 0.2760764448537877,
    "recall": 0.39406222611744085,
    "f1_score": 0.3246829444419371,
    "f2_score": 0.36303263963182014,
    "specificity": 0.9460201909208991,
    "negative_predictive_value": 0.9676229724112738,
    "g_mean": 0.6105659852844211,
    "youden_j": 0.34008241703833986,
    "matthews_corrcoef": 0.2878851973519471,
    "cohen_kappa": 0.2828080317061251,
    "balanced_accuracy": 0.6700412085191699,
    "roc_auc": 0.8345756405582824,
    "pr_auc": 0.30031614806643675,
    "brier_score": 0.0977807521893018
  },
  "thresholds": {
    "cardiomegaly": 0.7069228887557983,
    "aortic elongation": 0.6868770122528076,
    "unchanged": 0.4734758734703064,
    "scoliosis": 0.7466915845870972,
    "costophrenic angle blunting": 0.8649069666862488,
    "air trapping": 0.7717624306678772,
    "pleural effusion": 0.8400155901908875,
    "interstitial pattern": 0.6999356150627136,
    "vertebral degenerative changes": 0.5531110763549805,
    "laminar atelectasis": 0.8420376181602478
  },
  "used_files": {
    "x_val": "/kaggle/input/padchestaug/X_val.npy",
    "y_val": "/kaggle/input/padchestaug/Y_simp_val.npy",
    "x_test": "/kaggle/input/padchestaug/X_test.npy",
    "y_test": "/kaggle/input/padchestaug/Y_simp_test.npy",
    "taxonomy_dir": "/kaggle/input/taxonomy"
  }
}